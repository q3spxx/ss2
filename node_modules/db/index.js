var sqlite3 = require('sqlite3').verbose();
var db = new sqlite3.Database('./node_modules/db/data.db');
// db.run("CREATE TABLE movies (name TEXT, format INT)")
// //db.run("DROP TABLE test3")
// //db.run("ALTER TABLE test3 ADD cd TEXT")
// //db.run("INSERT INTO movies (name, format) VALUES ('Kubo', 0)")
// //db.run("DELETE FROM test3")
// //db.run("UPDATE test3 SET d = 18 WHERE info='qqqq'")
// db.all("SELECT rowid AS id, * FROM movies", function (err, rows) {
// 	console.log(rows)
// })

// // db.serialize(function() {
// //   	//db.run("CREATE TABLE test3 (info TEXT, lol INT)");
// //  	//db.run("ALTER TABLE test3 ADD e INTEGER");
// //  	db.run("ALTER TABLE test3 DROP COLUMN e");
// //  	//db.run("INSERT INTO test3 (c) VALUES (32)")
// //   // var stmt = db.prepare("INSERT INTO test VALUES (?)");
// //   // for (var i = 0; i < 10; i++) {
// //   //     stmt.run("Ipsum " + i);
// //   // }
// //   // stmt.finalize();
 
// //   db.each("SELECT * FROM test3", function(err, row) {
// //       console.log(row);
// //   });
// // });
 
// db.close();

var DB = {
	add: function (name, format) {
		db.run("INSERT INTO movies (name, format) VALUES (?, ?)", name, format)
	},
	get: function () {
		return new Promise(function (resolve, reject) {
			db.all("SELECT * FROM movies", function (err, rows) {
				resolve(rows)
			})
		})
	},
	set: function (id, name) {
		db.run("UPDATE movies SET name = ? WHERE rowid = ?", name, id)
	}
}

exports.add = DB.add
exports.get = DB.get
exports.set = DB.set